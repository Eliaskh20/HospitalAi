<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Health Prediction</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
    <header>
        <img src="{{ url_for('static', filename='img/header-main.jpg') }}" alt="Header Image">
        <h1>شركة هوميتكس الهندسية لتكنولوجيا المعلومات</h1>
        <h3>معكم نحو تكنولوجيا أفضل</h3>
    </header>
    <h1 class="project_name">Homedical Assistant</h1>
    <div id="mySidebar" class="sidebar">
        <button class="closebtn" onclick="closeNav()">&times;</button>

        <a href="{{ url_for('index') }}">
            <i class="fas fa-home"></i> الرئيسية
        </a>

        <a href="{{ url_for('page1') }}">
            <i class="fas fa-vial"></i> سكر الدم
        </a>
        <a href="{{ url_for('page2') }}">
            <i class="fas fa-heartbeat"></i> أمراض القلب
        </a>

        <a href="{{ url_for('page3') }}">
            <i class="fas fa-brain"></i> مرض باركنسون
        </a>
        <a href="{{ url_for('page4') }}">
            <i class="fas fa-pills"></i> أمراض الغدة الدرقية
        </a>
        <a href="{{ url_for('page5') }}">
           <i class="fas fa-virus"></i> أمراض الكبد
        </a>
        <a href="{{ url_for('page6') }}">
           <i class="fas fa-poll"></i> اختبار الاكتئاب
        </a>

        <a href="{{ url_for('page11') }}">
            <i class="fas fa-vial"></i> سرطان الرئة
        </a>
    </div>

    <button class="openbtn" onclick="openNav()">☰</button>

        <!-- Lung Cancer Prediction Form -->
        <form id="knn-form" action="{{ url_for('page11') }}" method="post">
            <h1>توقع سرطان الرئة</h1>

            <div class="form-row">
                <div>
                    <label for="gender">الجنس:</label>
                    <select id="gender" name="GENDER" required>
                        <option value="1">ذكر (1)</option>
                        <option value="0">أنثى (0)</option>
                    </select>
                </div>
                <div>
                    <label for="age">العمر:</label>
                    <input type="number" id="age" name="AGE" min="0" required>
                </div>
                <div>
                    <label for="smoking">هل تدخن؟</label>
                    <select id="smoking" name="SMOKING" required>
                        <option value="1">نعم (1)</option>
                        <option value="0">لا (0)</option>
                    </select>
                </div>
                <div>
                    <label for="yellow_fingers">هل أصابعك صفراء؟</label>
                    <select id="yellow_fingers" name="YELLOW_FINGERS" required>
                        <option value="1">نعم (1)</option>
                        <option value="0">لا (0)</option>
                    </select>
                </div>
            </div>

            <div class="form-row">
                <div>
                    <label for="anxiety">هل تعاني من القلق؟</label>
                    <select id="anxiety" name="ANXIETY" required>
                        <option value="1">نعم (1)</option>
                        <option value="0">لا (0)</option>
                    </select>
                </div>
                <div>
                    <label for="peer_pressure">هل تتعرض لضغط الأقران؟</label>
                    <select id="peer_pressure" name="PEER_PRESSURE" required>
                        <option value="1">نعم (1)</option>
                        <option value="0">لا (0)</option>
                    </select>
                </div>
                <div>
                    <label for="chronic_disease">هل تعاني من أمراض مزمنة؟</label>
                    <select id="chronic_disease" name="CHRONIC_DISEASE" required>
                        <option value="1">نعم (1)</option>
                        <option value="0">لا (0)</option>
                    </select>
                </div>
                <div>
                    <label for="fatigue">هل تشعر بالتعب؟</label>
                    <select id="fatigue" name="FATIGUE" required>
                        <option value="1">نعم (1)</option>
                        <option value="0">لا (0)</option>
                    </select>
                </div>
            </div>

            <div class="form-row">
                <div>
                    <label for="allergy">هل تعاني من الحساسية؟</label>
                    <select id="allergy" name="ALLERGY" required>
                        <option value="1">نعم (1)</option>
                        <option value="0">لا (0)</option>
                    </select>
                </div>
                <div>
                    <label for="wheezing">هل تعاني من الصفير؟</label>
                    <select id="wheezing" name="WHEEZING" required>
                        <option value="1">نعم (1)</option>
                        <option value="0">لا (0)</option>
                    </select>
                </div>
                <div>
                    <label for="alcohol_consuming">هل تستهلك الكحول؟</label>
                    <select id="alcohol_consuming" name="ALCOHOL_CONSUMING" required>
                        <option value="1">نعم (1)</option>
                        <option value="0">لا (0)</option>
                    </select>
                </div>
                <div>
                    <label for="coughing">هل تعاني من السعال؟</label>
                    <select id="coughing" name="COUGHING" required>
                        <option value="1">نعم (1)</option>
                        <option value="0">لا (0)</option>
                    </select>
                </div>
            </div>

            <div class="form-row">
                <div>
                    <label for="shortness_of_breath">هل تعاني من ضيق في التنفس؟</label>
                    <select id="shortness_of_breath" name="SHORTNESS_OF_BREATH" required>
                        <option value="1">نعم (1)</option>
                        <option value="0">لا (0)</option>
                    </select>
                </div>
                <div>
                    <label for="swallowing_difficulty">هل تعاني من صعوبة في البلع؟</label>
                    <select id="swallowing_difficulty" name="SWALLOWING_DIFFICULTY" required>
                        <option value="1">نعم (1)</option>
                        <option value="0">لا (0)</option>
                    </select>
                </div>
                <div>
                    <label for="chest_pain">هل تشعر بألم في الصدر؟</label>
                    <select id="chest_pain" name="CHEST_PAIN" required>
                        <option value="1">نعم (1)</option>
                        <option value="0">لا (0)</option>
                    </select>
                </div>
            </div>

            <div class="form-submit">
                <button type="submit">توقع الآن</button>
            </div>
        </form>

    <div class="result-row">
        <div id="cancer" class="result-box">نتيجة التشخيص</div>
    </div>

    <footer>
        <p>تم إنشاء هذا النموذج بواسطة غرام العبدالله <i class="fas fa-heart"></i></p>
    </footer>

    <script>
        function openNav() {
            document.getElementById("mySidebar").classList.add("open");
            document.querySelector(".openbtn").classList.add("hidden");
        }

        function closeNav() {
            document.getElementById("mySidebar").classList.remove("open");
            document.querySelector(".openbtn").classList.remove("hidden");
        }

        document.getElementById('knn-form').onsubmit = async function(event) {
            event.preventDefault();

            const formData = new FormData(event.target);
            const formObject = Object.fromEntries(formData.entries());

            const diagnosisBox = document.getElementById('cancer');

            try {
                const response = await fetch('{{ url_for('page11') }}', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(formObject),
                });

                 const result = await response.json();
                diagnosisBox.textContent = result.lung_cancer_prediction;

                if (result.lung_cancer_prediction.includes('High Risk Detected')) {
                    diagnosisBox.className = 'result-box high-risk';
                } if (result.lung_cancer_prediction.includes('Low Risk Detected')) {
                    diagnosisBox.className = 'result-box low-risk';
                }

            } catch (error) {
                console.error('Error:', error);
                diagnosisBox.textContent = 'حدث خطأ';
                diagnosisBox.className = 'result-box high-risk';
            }
        };
    </script>
</body>
</html>
